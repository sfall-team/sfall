<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Hook types - sfall</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.3.0 --> <title>Hook types | sfall</title> <meta property="og:title" content="Hook types" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Sfall documentation" /> <meta property="og:description" content="Sfall documentation" /> <link rel="canonical" href="/hook-types/" /> <meta property="og:url" content="/hook-types/" /> <meta property="og:site_name" content="sfall" /> <script type="application/ld+json"> {"@type":"WebPage","image":null,"url":"/hook-types/","headline":"Hook types","dateModified":null,"datePublished":null,"sameAs":null,"author":null,"mainEntityOfPage":null,"publisher":null,"description":"Sfall documentation","name":null,"@context":"http://schema.org"}</script> <!-- End Jekyll SEO tag --> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png"> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png"> <link rel="manifest" href="/assets/favicon/site.webmanifest"> <link rel="mask-icon" href="/assets/favicon/safari-pinned-tab.svg" color="#5bbad5"> <meta name="msapplication-TileColor" content="#da532c"> <meta name="msapplication-config" content="/assets/favicon/browserconfig.xml"> <meta name="theme-color" content="#ffffff"> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> sfall </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/arrays/" class="nav-list-link">Arrays</a><ul class="nav-list "><li class="nav-list-item "><a href="/array-functions/" class="nav-list-link">Array functions</a></li><li class="nav-list-item "><a href="/lists/" class="nav-list-link">Lists</a></li></ul></li><li class="nav-list-item"><a href="/best-practices/" class="nav-list-link">Best practices</a></li><li class="nav-list-item"><a href="/data-types/" class="nav-list-link">Data types</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/global-scripts/" class="nav-list-link">Global scripts</a><ul class="nav-list "><li class="nav-list-item "><a href="/global-script-functions/" class="nav-list-link">Global script functions</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/hooks/" class="nav-list-link">Hooks</a><ul class="nav-list "><li class="nav-list-item "><a href="/hook-functions/" class="nav-list-link">Hook functions</a></li><li class="nav-list-item active"><a href="/hook-types/" class="nav-list-link active">Hook types</a></li></ul></li><li class="nav-list-item"><a href="/sslc/" class="nav-list-link">SSLC</a></li><li class="nav-list-item"><a href="/optimization/" class="nav-list-link">Optimization</a></li><li class="nav-list-item"><a href="/animations/" class="nav-list-link">Animations</a></li><li class="nav-list-item"><a href="/art-and-appearance/" class="nav-list-link">Art and appearance</a></li><li class="nav-list-item"><a href="/audio/" class="nav-list-link">Audio</a></li><li class="nav-list-item"><a href="/car/" class="nav-list-link">Car</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/combat/" class="nav-list-link">Combat</a><ul class="nav-list "><li class="nav-list-item "><a href="/knockback/" class="nav-list-link">Knockback</a></li><li class="nav-list-item "><a href="/weapons-and-ammo/" class="nav-list-link">Weapons and ammo</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/direct-memory-access/" class="nav-list-link">Direct memory access</a><ul class="nav-list "><li class="nav-list-item "><a href="/call_offset_vx/" class="nav-list-link">call_offset_vX</a></li><li class="nav-list-item "><a href="/read_xxx/" class="nav-list-link">read_xxx</a></li><li class="nav-list-item "><a href="/write_xxx/" class="nav-list-link">write_xxx</a></li></ul></li><li class="nav-list-item"><a href="/explosions/" class="nav-list-link">Explosions</a></li><li class="nav-list-item"><a href="/global-variables/" class="nav-list-link">Global variables</a></li><li class="nav-list-item"><a href="/graphics/" class="nav-list-link">Graphics</a></li><li class="nav-list-item"><a href="/ini-settings/" class="nav-list-link">INI settings</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/interface/" class="nav-list-link">Interface</a><ul class="nav-list "><li class="nav-list-item "><a href="/cursor/" class="nav-list-link">Cursor</a></li><li class="nav-list-item "><a href="/inventory/" class="nav-list-link">Inventory</a></li><li class="nav-list-item "><a href="/main-interface/" class="nav-list-link">Main interface</a></li><li class="nav-list-item "><a href="/outline/" class="nav-list-link">Outline</a></li><li class="nav-list-item "><a href="/pip-boy/" class="nav-list-link">Pip-Boy</a></li><li class="nav-list-item "><a href="/tags/" class="nav-list-link">Tags</a></li><li class="nav-list-item "><a href="/windows-and-images/" class="nav-list-link">Windows and images</a></li></ul></li><li class="nav-list-item"><a href="/keyboard-and-mouse/" class="nav-list-link">Keyboard and mouse</a></li><li class="nav-list-item"><a href="/locks/" class="nav-list-link">Locks</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/maps-and-encounters/" class="nav-list-link">Maps and encounters</a><ul class="nav-list "><li class="nav-list-item "><a href="/rest/" class="nav-list-link">Rest</a></li><li class="nav-list-item "><a href="/worldmap/" class="nav-list-link">Worldmap</a></li></ul></li><li class="nav-list-item"><a href="/objects-and-scripts/" class="nav-list-link">Objects and scripts</a></li><li class="nav-list-item"><a href="/other/" class="nav-list-link">Other</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/perks-and-traits/" class="nav-list-link">Perks and traits</a><ul class="nav-list "><li class="nav-list-item "><a href="/npc-perks/" class="nav-list-link">NPC perks</a></li></ul></li><li class="nav-list-item"><a href="/sfall-funcx-macros/" class="nav-list-link">Sfall funcX macros</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/sfall/" class="nav-list-link">Sfall</a><ul class="nav-list "><li class="nav-list-item "><a href="/funcx/" class="nav-list-link">funcX</a></li><li class="nav-list-item "><a href="/version/" class="nav-list-link">Version</a></li></ul></li><li class="nav-list-item"><a href="/skills/" class="nav-list-link">Skills</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/stats/" class="nav-list-link">Stats</a><ul class="nav-list "><li class="nav-list-item "><a href="/alter-min-max/" class="nav-list-link">Alter min/max</a></li></ul></li><li class="nav-list-item"><a href="/tiles-and-paths/" class="nav-list-link">Tiles and paths</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/variables/" class="nav-list-link">Variables</a><ul class="nav-list "><li class="nav-list-item "><a href="/math/" class="nav-list-link">Math</a></li><li class="nav-list-item "><a href="/strings/" class="nav-list-link">Strings</a></li></ul></li><li class="nav-list-item"><a href="/virtual-file-system/" class="nav-list-link">Virtual file system</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search sfall" aria-label="Search sfall" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://nma-fallout.com/threads/fo2-engine-tweaks-sfall.178390/" class="site-button" > Forum </a> </li> <li class="aux-nav-list-item"> <a href="https://github.com/phobos2077/sfall/" class="site-button" > GitHub </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/hooks/">Hooks</a></li> <li class="breadcrumb-nav-list-item"><span>Hook types</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="hook-types"> <a href="#hook-types" class="anchor-heading" aria-labelledby="hook-types"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hook types </h1> <ul id="markdown-toc"> <li><a href="#adjustfid" id="markdown-toc-adjustfid">AdjustFID</a></li> <li><a href="#adjustpoison" id="markdown-toc-adjustpoison">AdjustPoison</a></li> <li><a href="#adjustrads" id="markdown-toc-adjustrads">AdjustRads</a></li> <li><a href="#afterhitroll" id="markdown-toc-afterhitroll">AfterHitRoll</a></li> <li><a href="#ammocost" id="markdown-toc-ammocost">AmmoCost</a></li> <li><a href="#barterprice" id="markdown-toc-barterprice">BarterPrice</a></li> <li><a href="#bestweapon" id="markdown-toc-bestweapon">BestWeapon</a></li> <li><a href="#calcapcost" id="markdown-toc-calcapcost">CalcAPCost</a></li> <li><a href="#canuseweapon" id="markdown-toc-canuseweapon">CanUseWeapon</a></li> <li><a href="#cartravel" id="markdown-toc-cartravel">CarTravel</a></li> <li><a href="#combatdamage" id="markdown-toc-combatdamage">CombatDamage</a></li> <li><a href="#combatturn" id="markdown-toc-combatturn">CombatTurn</a></li> <li><a href="#deathanim1" id="markdown-toc-deathanim1">DeathAnim1</a></li> <li><a href="#deathanim2" id="markdown-toc-deathanim2">DeathAnim2</a></li> <li><a href="#deprecated-hooks" id="markdown-toc-deprecated-hooks">Deprecated hooks</a></li> <li><a href="#descriptionobj" id="markdown-toc-descriptionobj">DescriptionObj</a></li> <li><a href="#encounter" id="markdown-toc-encounter">Encounter</a></li> <li><a href="#explosivetimer" id="markdown-toc-explosivetimer">ExplosiveTimer</a></li> <li><a href="#findtarget" id="markdown-toc-findtarget">FindTarget</a></li> <li><a href="#gamemodechange" id="markdown-toc-gamemodechange">GameModeChange</a></li> <li><a href="#invenwield" id="markdown-toc-invenwield">InvenWield</a></li> <li><a href="#inventorymove" id="markdown-toc-inventorymove">InventoryMove</a></li> <li><a href="#itemdamage" id="markdown-toc-itemdamage">ItemDamage</a></li> <li><a href="#keypress" id="markdown-toc-keypress">KeyPress</a></li> <li><a href="#mouseclick" id="markdown-toc-mouseclick">MouseClick</a></li> <li><a href="#movecost" id="markdown-toc-movecost">MoveCost</a></li> <li><a href="#ondeath" id="markdown-toc-ondeath">OnDeath</a></li> <li><a href="#onexplosion" id="markdown-toc-onexplosion">OnExplosion</a></li> <li><a href="#removeinvenobj" id="markdown-toc-removeinvenobj">RemoveInvenObj</a></li> <li><a href="#resttimer" id="markdown-toc-resttimer">RestTimer</a></li> <li><a href="#rollcheck" id="markdown-toc-rollcheck">RollCheck</a></li> <li><a href="#setglobalvar" id="markdown-toc-setglobalvar">SetGlobalVar</a></li> <li><a href="#setlighting" id="markdown-toc-setlighting">SetLighting</a></li> <li><a href="#sneak" id="markdown-toc-sneak">Sneak</a></li> <li><a href="#stdprocedure" id="markdown-toc-stdprocedure">StdProcedure</a></li> <li><a href="#stdprocedureend" id="markdown-toc-stdprocedureend">StdProcedureEnd</a></li> <li><a href="#steal" id="markdown-toc-steal">Steal</a></li> <li><a href="#subcombatdamage" id="markdown-toc-subcombatdamage">SubCombatDamage</a></li> <li><a href="#targetobject" id="markdown-toc-targetobject">TargetObject</a></li> <li><a href="#tohit" id="markdown-toc-tohit">ToHit</a></li> <li><a href="#useanimobj" id="markdown-toc-useanimobj">UseAnimObj</a></li> <li><a href="#useobj" id="markdown-toc-useobj">UseObj</a></li> <li><a href="#useobjon" id="markdown-toc-useobjon">UseObjOn</a></li> <li><a href="#useskill" id="markdown-toc-useskill">UseSkill</a></li> <li><a href="#useskillon" id="markdown-toc-useskillon">UseSkillOn</a></li> <li><a href="#withinperception" id="markdown-toc-withinperception">WithinPerception</a></li> </ul><hr /> <h2 id="adjustfid"> <a href="#adjustfid" class="anchor-heading" aria-labelledby="adjustfid"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AdjustFID </h2> <p><code class="highlighter-rouge">HOOK_ADJUSTFID</code> (hs_adjustfid.int)</p> <p>Runs after calculating character figure FID on the inventory screen, whenever the game decides that character appearance might change. Also happens on other screens, like barter.</p> <p><strong>NOTE:</strong> FID has following format: <code class="highlighter-rouge">0x0ABBCDDD</code>, where: <code class="highlighter-rouge">A</code> - object type, <code class="highlighter-rouge">BB</code> - animation code (always 0 in this case), <code class="highlighter-rouge">C</code> - weapon code, <code class="highlighter-rouge">DDD</code> - FRM index in LST file.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - the vanilla FID calculated by the engine according to critter base FID and armor/weapon being used
int     arg1 - the modified FID calculated by the internal sfall code (like Hero Appearance Mod)

int     ret0 - overrides the calculated FID with provided value
</code></pre></div></div> <h2 id="adjustpoison"> <a href="#adjustpoison" class="anchor-heading" aria-labelledby="adjustpoison"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AdjustPoison </h2> <p><code class="highlighter-rouge">HOOK_ADJUSTPOISON</code> (hs_adjustpoison.int)</p> <p>Runs when a critter’s poison level is changed, or when the player takes damage from the poison.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter
int     arg1 - the amount of poison being added/removed
int     arg2 - the damage value at the time of applying the poison effect
               (damage from the poison effect is implemented only for the player character; for other critters, this value will always be 0)

int     ret0 - the new amount of poison being added/removed
int     ret1 - the new damage value, only negative values are allowed (will only be valid at the time of taking damage from the poison)
</code></pre></div></div> <h2 id="adjustrads"> <a href="#adjustrads" class="anchor-heading" aria-labelledby="adjustrads"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AdjustRads </h2> <p><code class="highlighter-rouge">HOOK_ADJUSTRADS</code> (hs_adjustrads.int)</p> <p>Runs when a critter’s radiation level is changed.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter (usually dude_obj)
int     arg1 - the amount of radiation being added/removed

int     ret0 - the new amount of radiation being added/removed
</code></pre></div></div> <h2 id="afterhitroll"> <a href="#afterhitroll" class="anchor-heading" aria-labelledby="afterhitroll"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AfterHitRoll </h2> <p><code class="highlighter-rouge">HOOK_AFTERHITROLL</code> (hs_afterhitroll.int)</p> <p>Runs after Fallout has decided if an attack will hit or miss.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - If the attack will hit: 0 - critical miss, 1 - miss, 2 - hit, 3 - critical hit
Critter arg1 - The attacker
Critter arg2 - The target of the attack
int     arg3 - The bodypart
int     arg4 - The hit chance

int     ret0 - Override the hit/miss
int     ret1 - Override the targeted bodypart
Critter ret2 - Override the target of the attack
</code></pre></div></div> <h2 id="ammocost"> <a href="#ammocost" class="anchor-heading" aria-labelledby="ammocost"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AmmoCost </h2> <p><code class="highlighter-rouge">HOOK_AMMOCOST</code> (hs_ammocost.int)</p> <p>Runs when calculating ammo cost for a weapon. Doesn’t affect damage, only how much ammo is spent. By default, weapon will shoot when at least 1 round is left, regardless of ammo cost calculations. To add proper check for ammo before shooting and proper calculation of number of burst rounds (hook type 1 and 2 in arg3), set <strong>CheckWeaponAmmoCost=1</strong> in <strong>Misc</strong> section of ddraw.ini.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Item    arg0 - The weapon
int     arg1 - Number of bullets in burst or 1 for single shots
int     arg2 - The amount of ammo that will be consumed, calculated by the original ammo cost function (this is basically 2 for Super Cattle Prod and Mega Power Fist)
               NOTE: for hook type 2, this value is the ammo cost per round (default is always 1)
int     arg3 - Type of hook:
               0 - when subtracting ammo after single shot attack
               1 - when checking for "out of ammo" before attack
               2 - when calculating number of burst rounds
               3 - when subtracting ammo after burst attack

int     ret0 - The new amount of ammo to be consumed, or ammo cost per round for hook type 2 (set to 0 for unlimited ammo)
</code></pre></div></div> <h2 id="barterprice"> <a href="#barterprice" class="anchor-heading" aria-labelledby="barterprice"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> BarterPrice </h2> <p><code class="highlighter-rouge">HOOK_BARTERPRICE</code> (hs_barterprice.int)</p> <p>Runs whenever the value of goods being purchased is calculated.</p> <p>NOTE: the hook is executed twice when entering the barter screen or after transaction: the first time is for the player and the second time is for NPC.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter doing the bartering (either dude_obj or inven_dude)
Critter arg1 - the critter being bartered with
int     arg2 - the default value of the goods
Critter arg3 - table of requested goods (being bought from NPC)
int     arg4 - the amount of actual caps in the barter stack (as opposed to goods)
int     arg5 - the value of all goods being traded before skill modifications
Critter arg6 - table of offered goods (being sold to NPC)
int     arg7 - the total cost of the goods offered by the player
int     arg8 - 1 if the "offers" button was pressed (not for a party member), 0 otherwise
int     arg9 - 1 if trading with a party member, 0 otherwise

int     ret0 - the modified value of all of the goods (pass -1 if you just want to modify offered goods)
int     ret1 - the modified value of all offered goods
</code></pre></div></div> <h2 id="bestweapon"> <a href="#bestweapon" class="anchor-heading" aria-labelledby="bestweapon"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> BestWeapon </h2> <p><code class="highlighter-rouge">HOOK_BESTWEAPON</code> (hs_bestweapon.int)</p> <p>Runs when the AI decides which weapon is the best while searching the inventory for a weapon to equip in combat. This also runs when the player presses the “Use Best Weapon” button on the party member control panel.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter searching for a weapon
Item    arg1 - the best weapon chosen from two items
Item    arg2 - the first choice of weapon
Item    arg3 - the second choice of weapon
Critter arg4 - the target of the critter (can be 0)

Item    ret0 - overrides the chosen best weapon
</code></pre></div></div> <h2 id="calcapcost"> <a href="#calcapcost" class="anchor-heading" aria-labelledby="calcapcost"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CalcAPCost </h2> <p><code class="highlighter-rouge">HOOK_CALCAPCOST</code> (hs_calcapcost.int)</p> <p>Runs whenever Fallout is calculating the AP cost of using the weapon (or unarmed attack). Doesn’t run for using other item types or moving. Note that the first time a game is loaded, this script doesn’t run before the initial interface is drawn, so if the script effects the AP cost of whatever is in the player’s hands at the time the wrong AP cost will be shown. It will be fixed the next time the interface is redrawn. You can get the weapon object by checking item slot based on attack type (<code class="highlighter-rouge">ATKTYPE_LWEP1</code>, <code class="highlighter-rouge">ATKTYPE_LWEP2</code>, etc) and then calling <code class="highlighter-rouge">critter_inven_obj</code>.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - The critter performing the action
int     arg1 - Attack Type (see ATKTYPE_* constants)
int     arg2 - Is aimed attack (1 or 0)
int     arg3 - The default AP cost
Item    arg4 - The weapon for which the cost is calculated. If it is 0, the pointer to the weapon can still be obtained by the aforementioned method

int     ret0 - The new AP cost
</code></pre></div></div> <h2 id="canuseweapon"> <a href="#canuseweapon" class="anchor-heading" aria-labelledby="canuseweapon"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CanUseWeapon </h2> <p><code class="highlighter-rouge">HOOK_CANUSEWEAPON</code> (hs_canuseweapon.int)</p> <p>Run when the AI checks whether it can use a weapon. This mostly happens when NPCs try to find weapons in their inventory or on the map.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter doing the check
Item    arg1 - the weapon being checked
int     arg2 - attack type (see ATKTYPE_* constants)
int     arg3 - original result of engine function: 1 - can use, 0 - can't use

int     ret0 - overrides the result of engine function. Any non-zero value allows using the weapon
</code></pre></div></div> <h2 id="cartravel"> <a href="#cartravel" class="anchor-heading" aria-labelledby="cartravel"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CarTravel </h2> <p><code class="highlighter-rouge">HOOK_CARTRAVEL</code> (hs_cartravel.int)</p> <p>Runs continuously during worldmap travel on car.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - vanilla car speed (between 3 and 8 "steps")
int     arg1 - vanilla fuel consumption (100 and below)

int     ret0 - car speed override (pass -1 if you just want to override fuel consumption)
int     ret1 - fuel consumption override
</code></pre></div></div> <h2 id="combatdamage"> <a href="#combatdamage" class="anchor-heading" aria-labelledby="combatdamage"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CombatDamage </h2> <p><code class="highlighter-rouge">HOOK_COMBATDAMAGE</code> (hs_subcombatdmg.int)</p> <p>Runs when:</p> <ol> <li>Game calculates how much damage each target will get. This includes primary target as well as all extras (explosions and bursts). This happens BEFORE the actual attack animation.</li> <li>AI decides whether it is safe to use area attack (burst, grenades), if he might hit friendlies.</li> </ol> <p>Does not run for misses, or non-combat damage like dynamite explosions.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0  - The target
Critter arg1  - The attacker
int     arg2  - The amount of damage to the target
int     arg3  - The amount of damage to the attacker
int     arg4  - The special effect flags for the target (use bwand DAM_* to check specific flags)
int     arg5  - The special effect flags for the attacker (use bwand DAM_* to check specific flags)
int     arg6  - The weapon used in the attack
int     arg7  - The bodypart that was struck
int     arg8  - Damage Multiplier (this is divided by 2, so a value of 3 does 1.5x damage, and 8 does 4x damage. Usually it's 2; for critical hits, the value is taken from the critical table; with Silent Death perk and the corresponding attack conditions, the value will be doubled)
int     arg9 - Number of bullets actually hit the target (1 for melee attacks)
int     arg10 - The amount of knockback to the target
int     arg11 - Attack Type (see ATKTYPE_* constants)
mixed   arg12 - computed attack data (see C_ATTACK_* for offsets and use get/set_object_data functions to get/set the data)

int     ret0 - The damage to the target
int     ret1 - The damage to the attacker
int     ret2 - The special effect flags for the target
int     ret3 - The special effect flags for the attacker
int     ret4 - The amount of knockback to the target
</code></pre></div></div> <h2 id="combatturn"> <a href="#combatturn" class="anchor-heading" aria-labelledby="combatturn"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CombatTurn </h2> <p><code class="highlighter-rouge">HOOK_COMBATURN</code> (hs_combatturn.int)</p> <p>Runs before and after each turn in combat (for both PC and NPC).</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - event type:
               1 - start of turn
               0 - normal end of turn
              -1 - combat ends abruptly (by script or by pressing Enter during PC turn)
              -2 - combat ends normally (hook always runs at the end of combat)
Critter arg1 - critter doing the turn
bool    arg2 - 1 at the start/end of the player's turn after loading a game saved in combat mode, 0 otherwise

int     ret0 - pass 1 at the start of turn to skip the turn, pass -1 at the end of turn to force end of combat
</code></pre></div></div> <h2 id="deathanim1"> <a href="#deathanim1" class="anchor-heading" aria-labelledby="deathanim1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DeathAnim1 </h2> <p><code class="highlighter-rouge">HOOK_DEATHANIM1</code> (hs_deathanim1.int)</p> <p>Runs before Fallout tries to calculate the death animation. Lets you switch out which weapon Fallout sees. Does not run for critters in the knockdown/out state.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - The pid of the weapon performing the attack. (May be -1 if the attack is unarmed)
Critter arg1 - The attacker
Critter arg2 - The target
int     arg3 - The amount of damage
int     arg4 - Unused, always -1. Use this if you are using the same procedure for HOOK_DEATHANIM1 and HOOK_DEATHANIM2 (since sfall 4.1/3.8.24)

int     ret0 - The pid of an object to override the attacking weapon with
</code></pre></div></div> <h2 id="deathanim2"> <a href="#deathanim2" class="anchor-heading" aria-labelledby="deathanim2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DeathAnim2 </h2> <p><code class="highlighter-rouge">HOOK_DEATHANIM2</code> (hs_deathanim2.int)</p> <p>Runs after Fallout has calculated the death animation. Lets you set your own custom frame id, so more powerful than <code class="highlighter-rouge">HOOK_DEATHANIM1</code>, but performs no validation. When using <code class="highlighter-rouge">critter_dmg</code> function, this script will also run. In that case weapon pid will be -1 and attacker will point to an object with <code class="highlighter-rouge">obj_art_fid == 0x20001F5</code>. Does not run for critters in the knockdown/out state.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Item    arg0 - The pid of the weapon performing the attack. (May be -1 if the attack is unarmed)
Critter arg1 - The attacker
Critter arg2 - The target
int     arg3 - The amount of damage
int     arg4 - The death anim id calculated by Fallout

int     ret0 - The death anim id to override with
</code></pre></div></div> <h2 id="deprecated-hooks"> <a href="#deprecated-hooks" class="anchor-heading" aria-labelledby="deprecated-hooks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Deprecated hooks </h2> <ul> <li><code class="highlighter-rouge">hs_hexmoveblocking.int</code></li> <li><code class="highlighter-rouge">hs_hexaiblocking.int</code></li> <li><code class="highlighter-rouge">hs_hexshootblocking.int</code></li> <li><code class="highlighter-rouge">hs_hexsightblocking.int</code></li> </ul> <p>Run when checking to see if a hex blocks movement or shooting. (or ai-ing, presumably…)</p> <p><strong>NOTE:</strong> These hook scripts can become very CPU-intensive and you should avoid using them. For this reason, these hooks are not thoroughly supported in sfall, and may be removed in future versions.<br /> If you want to check if some tile or path is blocked, use functions: <code class="highlighter-rouge">obj_blocking_tile</code>, <code class="highlighter-rouge">obj_blocking_line</code>, <code class="highlighter-rouge">path_find_to</code>.<br /> If you want script to be called every time NPC moves by hex in combat, use <code class="highlighter-rouge">HOOK_MOVECOST</code> hook.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter doing the moving
int     arg1 - the tile number being checked
int     arg2 - the elevation being checked
int     arg3 - 1 if the hex would normally be blocking

Obj     ret0 - 0 if the hex doesn't block, or any sort of object pointer if it does
</code></pre></div></div> <h2 id="descriptionobj"> <a href="#descriptionobj" class="anchor-heading" aria-labelledby="descriptionobj"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DescriptionObj </h2> <p><code class="highlighter-rouge">HOOK_DESCRIPTIONOBJ</code> (hs_descriptionobj.int)</p> <p>Runs when using the examine action icon to display the description of an object. You can override the description text. An example usage would be to add an additional description to the item based on player’s stats/skills. Does not run if the script of the object overrides the description.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Obj     arg0 - the object

int     ret0 - a pointer to the new text received by using "get_string_pointer" function
</code></pre></div></div> <h2 id="encounter"> <a href="#encounter" class="anchor-heading" aria-labelledby="encounter"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Encounter </h2> <p><code class="highlighter-rouge">HOOK_ENCOUNTER</code> (hs_encounter.int)</p> <p>Runs whenever a random encounter occurs (except the Horrigan meeting and scripted encounters), or when the player enters a local map from the world map. You can override the map for loading or the encounter.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - event type: 0 - when a random encounter occurs, 1 - when the player enters from the world map
int     arg1 - the map ID that the encounter will load (see MAPS.h or Maps.txt)
int     arg2 - 1 when the encounter occurs is a special encounter, 0 otherwise

int     ret0 - overrides the map ID, or pass -1 for event type 0 to cancel the encounter and continue traveling
int     ret1 - pass 1 to cancel the encounter and load the specified map from the ret0 (only for event type 0)
</code></pre></div></div> <h2 id="explosivetimer"> <a href="#explosivetimer" class="anchor-heading" aria-labelledby="explosivetimer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ExplosiveTimer </h2> <p><code class="highlighter-rouge">HOOK_EXPLOSIVETIMER</code> (hs_explosivetimer.int)</p> <p>Runs after setting the explosive timer. You can override the result.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - the time in ticks set in the timer
Obj     arg1 - the explosive object
int     arg2 - the result of engine calculation of whether the timer was set successfully: 1 - failure, 2 - success (similar to ROLL_* in Condtion.h)

int     ret0 - overrides the time of the timer (maximum 18000 ticks)
int     ret1 - overrides the result of engine calculation: 0/1 - failure, 2/3 - success (similar to ROLL_*), any other value - use engine handler
</code></pre></div></div> <h2 id="findtarget"> <a href="#findtarget" class="anchor-heading" aria-labelledby="findtarget"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> FindTarget </h2> <p><code class="highlighter-rouge">HOOK_FINDTARGET</code> (hs_findtarget.int)</p> <p>Runs when the AI is trying to pick a target in combat. Fallout first chooses a list of 4 likely suspects, then normally sorts them in order of weakness/distance/etc depending on the AI caps of the attacker. This hook replaces that sorting function, allowing you to sort the targets in some arbitrary way.</p> <p>The return values can include critters that weren’t in the list of possible targets, but the additional targets may still be discarded later on in the combat turn if they are out of the attackers perception or the chance of a successful hit is too low. The list of possible targets often includes duplicated entries, but this is fixed in sfall 4.2.3/3.8.23. Use <code class="highlighter-rouge">set_sfall_return</code> to give the 4 targets, in order of preference. If you want to specify less than 4 targets, fill in the extra spaces with 0’s or pass -1 to skip the return value.</p> <p><strong>NOTE:</strong> The engine can choose targets by the following criteria: 1) The nearest enemy to the attacker. 2) The enemy that attacked the attacker. 3) The enemy that attacked an NPC from the same team as the attacker. 4) The enemy that is attacked by an NPC from the same team as the attacker.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - The attacker
Critter arg1 - A possible target
Critter arg2 - A possible target
Critter arg3 - A possible target
Critter arg4 - A possible target

Critter ret0 - The first choice of target
Critter ret1 - The second choice of target
Critter ret2 - The third choice of target
Critter ret3 - The fourth choice of target
</code></pre></div></div> <h2 id="gamemodechange"> <a href="#gamemodechange" class="anchor-heading" aria-labelledby="gamemodechange"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> GameModeChange </h2> <p><code class="highlighter-rouge">HOOK_GAMEMODECHANGE</code> (hs_gamemodechange.int)</p> <p>Runs once every time when the game mode was changed, like opening/closing the inventory, character screen, pipboy, etc.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - event type: 1 - when the player exits the game, 0 - otherwise
int     arg1 - the previous game mode
</code></pre></div></div> <h2 id="invenwield"> <a href="#invenwield" class="anchor-heading" aria-labelledby="invenwield"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> InvenWield </h2> <p><code class="highlighter-rouge">HOOK_INVENWIELD</code> (hs_invenwield.int)</p> <p>Runs before causing a critter or the player to wield/unwield an armor or a weapon (except when using the inventory by PC). An example usage would be to change critter art depending on armor being used or to dynamically customize weapon animations.</p> <p><strong>NOTE:</strong> When replacing a previously wielded armor or weapon, the unwielding hook will not be executed. If you need to rely on this, try checking if armor/weapon is already equipped when wielding hook is executed.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - critter
Item    arg1 - item being wielded or unwielded (weapon/armor)
int     arg2 - slot (INVEN_TYPE_*)
int     arg3 - 1 when wielding, 0 when unwielding
int     arg4 - 1 when removing an equipped item from inventory, 0 otherwise

int     ret0 - overrides hard-coded handler (-1 - use engine handler, any other value - override) - NOT RECOMMENDED
</code></pre></div></div> <h2 id="inventorymove"> <a href="#inventorymove" class="anchor-heading" aria-labelledby="inventorymove"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> InventoryMove </h2> <p><code class="highlighter-rouge">HOOK_INVENTORYMOVE</code> (hs_inventorymove.int)</p> <p>Runs before moving items between inventory slots in dude interface. You can override the action. What you can NOT do with this hook:</p> <ul> <li>force moving items to inappropriate slots (like gun in armor slot) What you can do:</li> <li>restrict player from using specific weapons or armors</li> <li>add AP costs for all inventory movement including reloading</li> <li>apply or remove some special scripted effects depending on PC’s armor</li> </ul> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - Target slot:
               0 - main backpack
               1 - left hand
               2 - right hand
               3 - armor slot
               4 - weapon, when reloading it by dropping ammo
               5 - container, like bag/backpack
               6 - dropping on the ground
               7 - picking up item
               8 - dropping item on the character portrait
Item    arg1 - Item being moved
Item    arg2 - Item being replaced, weapon being reloaded, or container being filled (can be 0)

int     ret0 - Override setting (-1 - use engine handler, any other value - prevent relocation of item/reloading weapon/picking up item)
</code></pre></div></div> <h2 id="itemdamage"> <a href="#itemdamage" class="anchor-heading" aria-labelledby="itemdamage"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ItemDamage </h2> <p><code class="highlighter-rouge">HOOK_ITEMDAMAGE</code> (hs_itemdamage.int)</p> <p>Runs when retrieving the damage rating of the player’s used weapon. (Which may be their fists.)</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - The default min damage
int     arg1 - The default max damage
Item    arg2 - The weapon used (0 if unarmed)
Critter arg3 - The critter doing the attacking
int     arg4 - The type of attack
int     arg5 - non-zero if this is an attack using a melee weapon

int     ret0 - Either the damage to be used, if ret1 isn't given, or the new minimum damage if it is
int     ret1 - The new maximum damage
</code></pre></div></div> <h2 id="keypress"> <a href="#keypress" class="anchor-heading" aria-labelledby="keypress"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> KeyPress </h2> <p><code class="highlighter-rouge">HOOK_KEYPRESS</code> (hs_keypress.int)</p> <p>Runs once every time when any key was pressed or released.</p> <ul> <li>DX codes: see <strong>dik.h</strong> header or https://kippykip.com/b3ddocs/commands/scancodes.htm</li> <li><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd375731%28v=vs.85%29.aspx">VK codes</a></li> </ul> <p><strong>NOTE:</strong> If you want to override a key, the new key DX scancode should be the same for both pressed and released events.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - event type: 1 - pressed, 0 - released
int     arg1 - key DX scancode
int     arg2 - key VK code (very similar to ASCII codes)

int     ret0 - overrides the pressed key (a new key DX scancode or 0 for no override)
</code></pre></div></div> <h2 id="mouseclick"> <a href="#mouseclick" class="anchor-heading" aria-labelledby="mouseclick"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MouseClick </h2> <p><code class="highlighter-rouge">HOOK_MOUSECLICK</code> (hs_mouseclick.int)</p> <p>Runs once every time when a mouse button was pressed or released.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - event type: 1 - pressed, 0 - released
int     arg1 - button number (0 - left, 1 - right, up to 7)
</code></pre></div></div> <h2 id="movecost"> <a href="#movecost" class="anchor-heading" aria-labelledby="movecost"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MoveCost </h2> <p><code class="highlighter-rouge">HOOK_MOVECOST</code> (hs_movecost.int)</p> <p>Runs when calculating the AP cost of movement.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter doing the moving
int     arg1 - the number of hexes being moved
int     arg2 - the original AP cost

int     ret0 - the new AP cost
</code></pre></div></div> <h2 id="ondeath"> <a href="#ondeath" class="anchor-heading" aria-labelledby="ondeath"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> OnDeath </h2> <p><code class="highlighter-rouge">HOOK_ONDEATH</code> (hs_ondeath.int)</p> <p>Runs immediately after a critter dies for any reason. No return values; this is just a convenience for when you need to do something after death for a large number of different critters and don’t want to have to script each and every one of them.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - The critter that just died
</code></pre></div></div> <h2 id="onexplosion"> <a href="#onexplosion" class="anchor-heading" aria-labelledby="onexplosion"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> OnExplosion </h2> <p><code class="highlighter-rouge">HOOK_ONEXPLOSION</code> (hs_onexplosion.int)</p> <p>Runs when Fallout is checking all the tiles within the explosion radius for targets before an explosion occurs. The tile checking will be interrupted when 6 additional targets (critters) are received.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - event type: 1 - when checking objects within the explosion radius without causing damage (e.g. the player drops an active explosive), 0 - otherwise
Critter arg1 - the attacker
int     arg2 - the tile on which the explosion occurs
int     arg3 - checked tile within the explosion radius
Obj     arg4 - first found object on the checked tile as an additional target
Critter arg5 - the target critter, may be 0 or equal to the attacker
int     arg6 - 1 when using throwing weapons (e.g. grenades), 0 otherwise

int     ret0 - overrides the found object on the checked tile, pass 0 to skip the object
</code></pre></div></div> <h2 id="removeinvenobj"> <a href="#removeinvenobj" class="anchor-heading" aria-labelledby="removeinvenobj"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RemoveInvenObj </h2> <p><code class="highlighter-rouge">HOOK_REMOVEINVENOBJ</code> (hs_removeinvenobj.int)</p> <p>Runs when an object is removed from a container or critter’s inventory for any reason.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Obj     arg0 - the owner that the object is being removed from
Item    arg1 - the item that is being removed
int     arg2 - the number of items to remove
int     arg3 - The reason the object is being removed (see RMOBJ_* constants)
Obj     arg4 - The destination object when the item is moved to another object, 0 otherwise
</code></pre></div></div> <h2 id="resttimer"> <a href="#resttimer" class="anchor-heading" aria-labelledby="resttimer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RestTimer </h2> <p><code class="highlighter-rouge">HOOK_RESTTIMER</code> (hs_resttimer.int)</p> <p>Runs continuously while the player is resting (using pipboy alarm clock).</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - the game time in ticks
int     arg1 - event type: 1 - when the resting ends normally, -1 - when pressing ESC to cancel the timer, 0 - otherwise
int     arg2 - the hour part of the length of resting time
int     arg3 - the minute part of the length of resting time

int     ret0 - pass 1 to interrupt the resting, pass 0 to continue the rest if it was interrupted by pressing ESC key
</code></pre></div></div> <h2 id="rollcheck"> <a href="#rollcheck" class="anchor-heading" aria-labelledby="rollcheck"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RollCheck </h2> <p><code class="highlighter-rouge">HOOK_ROLLCHECK</code> (hs_rollcheck.int)</p> <p>Runs when a game event performs a random roll to check the chance of success or failure.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - event type:
               1 - checks the chance of an attack hitting the target
               2 - checks the chance of a bullet from a burst hitting the target (for burst attacks)
               3 - checks the chance when using skills (not listed below)
               4 - check the chance of using Repair skill
               5 - check the chance of using Doctor skill
               6 - check the chance of using Steal skill for the thief (usually the player)
               7 - the second Steal skill chance check for the target to catch the thief, in which the target's failure is the thief's success result
int     arg1 - the value of roll result (see ROLL_* constants), which is calculated as:
               for ROLL_CRITICAL_SUCCESS: random(1, 100) &lt;= (random_chance / 10) + bonus
               for ROLL_CRITICAL_FAILURE: random(1, 100) &lt;= -random_chance / 10
int     arg2 - the chance value
int     arg3 - the bonus value, used when checking critical success
int     arg4 - random chance (calculated as: chance - random(1, 100)), where a negative value is a failure check (ROLL_FAILURE)

int     ret0 - overrides the roll result
</code></pre></div></div> <h2 id="setglobalvar"> <a href="#setglobalvar" class="anchor-heading" aria-labelledby="setglobalvar"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SetGlobalVar </h2> <p><code class="highlighter-rouge">HOOK_SETGLOBALVAR</code> (hs_setglobalvar.int)</p> <p>Runs when setting the value of a global variable.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - the index number of the global variable being set
int     arg1 - the set value of the global variable

int     ret0 - overrides the value of the global variable
</code></pre></div></div> <h2 id="setlighting"> <a href="#setlighting" class="anchor-heading" aria-labelledby="setlighting"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SetLighting </h2> <p><code class="highlighter-rouge">HOOK_SETLIGHTING</code> (hs_setlighting.int)</p> <p>Runs before setting the light level for an object or a map. You can override the result.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Obj     arg0 - the object being set, or -1 when setting the light level for a map
int     arg1 - the light intensity
int     arg2 - the light radius, or -1 when setting the light level for a map

int     ret0 - overrides the light intensity. Intensity range is from 0 to 65536
int     ret1 - overrides the light radius. Radius range is from 0 to 8 (works only for the object)
</code></pre></div></div> <h2 id="sneak"> <a href="#sneak" class="anchor-heading" aria-labelledby="sneak"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Sneak </h2> <p><code class="highlighter-rouge">HOOK_SNEAK</code> (hs_sneak.int)</p> <p>Runs when the Sneak skill is activated, or when the game rolls another Sneak check after the duration for the current one is over. You can override the result of a random Sneak check or the duration time for the current result.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - Sneak check result: 1 - success, 0 - failure
int     arg1 - the duration in ticks for the current Sneak check (time depends on Sneak skill level)
Critter arg2 - the critter (usually dude_obj)

int     ret0 - overrides the result of the Sneak check
int     ret1 - overrides the duration time for the current result
</code></pre></div></div> <h2 id="stdprocedure"> <a href="#stdprocedure" class="anchor-heading" aria-labelledby="stdprocedure"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> StdProcedure </h2> <p><code class="highlighter-rouge">HOOK_STDPROCEDURE</code> (hs_stdprocedure.int)</p> <p>Runs before Fallout executes a standard procedure (handler) in any script of any object. NOTE: this hook will not be executed for <code class="highlighter-rouge">start</code>, <code class="highlighter-rouge">critter_p_proc</code>, <code class="highlighter-rouge">timed_event_p_proc</code>, and <code class="highlighter-rouge">map_update_p_proc</code> procedures.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - the number of the standard script handler (see define.h)
Obj     arg1 - the object that owns this handler (self_obj)
Obj     arg2 - the object that called this handler (source_obj, can be 0)

int     ret0 - pass -1 to cancel the execution of the handler
</code></pre></div></div> <h2 id="stdprocedureend"> <a href="#stdprocedureend" class="anchor-heading" aria-labelledby="stdprocedureend"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> StdProcedureEnd </h2> <p><code class="highlighter-rouge">HOOK_STDPROCEDURE_END</code> (hs_stdprocedure.int)</p> <p>Runs after Fallout executes a standard procedure (handler) in any script of any object. NOTE: this hook will not be executed for <code class="highlighter-rouge">start</code>, <code class="highlighter-rouge">critter_p_proc</code>, <code class="highlighter-rouge">timed_event_p_proc</code>, and <code class="highlighter-rouge">map_update_p_proc</code> procedures.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - the number of the standard script handler (see define.h)
Obj     arg1 - the object that owns this handler (self_obj)
Obj     arg2 - the object that called this handler (source_obj, can be 0)
int     arg3 - 1 after procedure execution
</code></pre></div></div> <h2 id="steal"> <a href="#steal" class="anchor-heading" aria-labelledby="steal"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Steal </h2> <p><code class="highlighter-rouge">HOOK_STEAL</code> (hs_steal.int)</p> <p>Runs when checking an attempt to steal or plant an item in other inventory using Steal skill.</p> <p>This is fired before the default handlers are called, which you can override. In this case you MUST provide message of the result to player (“You steal the %s”, “You are caught planting the %s”, etc.). Example message (vanilla behavior):<br /> <code class="highlighter-rouge">display_msg(sprintf(mstr_skill(570 + (isSuccess != false) + arg3 * 2), obj_name(arg2)));</code></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - Thief
Obj     arg1 - The target
Item    arg2 - Item being stolen/planted
int     arg3 - 0 when stealing, 1 when planting

int     ret0 - overrides hard-coded handler (1 - force success, 0 - force fail, -1 - use engine handler)
</code></pre></div></div> <h2 id="subcombatdamage"> <a href="#subcombatdamage" class="anchor-heading" aria-labelledby="subcombatdamage"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SubCombatDamage </h2> <p><code class="highlighter-rouge">HOOK_SUBCOMBATDAMAGE</code> (hs_subcombatdamage.int)</p> <p>This hook overrides the vanilla damage calculation formula. Runs when:</p> <ol> <li>Before the game calculates how much damage each target will get. This includes primary target as well as all extras (explosions and bursts).</li> <li>AI decides whether it is safe to use area attack (burst, grenades), if he might hit friendlies.</li> </ol> <p>Does not run for misses, non-combat damage like dynamite explosions, or if one of the damage formulas is selected in ddraw.ini.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the attacker
Critter arg1 - the target
Item    arg2 - the weapon used in the attack
int     arg3 - attack type (see ATKTYPE_* constants)
int     arg4 - number of bullets actually hit the target (1 for melee attacks)
int     arg5 - target's Damage Resistance (DR) value (affected by critical hit effects, perks, traits, and special unarmed attacks)
int     arg6 - target's Damage Threshold (DT) value (affected by critical hit effects, perks, traits, and special unarmed attacks)
int     arg7 - bonus ranged damage from the perk
int     arg8 - damage multiplier (this is divided by 2, so a value of 3 does 1.5x damage, and 8 does 4x damage. Usually it's 2; for critical hits, the value is taken from the critical table; with Silent Death perk and the corresponding attack conditions, the value will be doubled)
int     arg9 - combat difficulty multiplier (125 - rough, 100 - normal, 75 - wimpy; for player or party members it's always 100)
int     arg10 - the calculated amount of damage (usually 0, required when using multiple hook scripts to calculate damage and using the set_sfall_arg function)
mixed   arg11 - computed attack data (see C_ATTACK_* for offsets and use get/set_object_data functions to get/set the data)

int     ret0 - the returned amount of damage
</code></pre></div></div> <h2 id="targetobject"> <a href="#targetobject" class="anchor-heading" aria-labelledby="targetobject"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> TargetObject </h2> <p><code class="highlighter-rouge">HOOK_TARGETOBJECT</code> (hs_targetobject.int)</p> <p>Runs when the targeting cursor hovers over an object, or when the player tries to attack the target object. You can override the target object or prevent the player from attacking the chosen target.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - event type: 0 - when the targeting cursor hovers over the object, 1 - when trying to attack the target object
int     arg1 - 1 when the target object is valid to attack, 0 otherwise
Obj     arg2 - the target object

mixed   ret0 - overrides the target object, or pass -1 to prevent the player from attacking the object
</code></pre></div></div> <h2 id="tohit"> <a href="#tohit" class="anchor-heading" aria-labelledby="tohit"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ToHit </h2> <p><code class="highlighter-rouge">HOOK_TOHIT</code> (hs_tohit.int)</p> <p>Runs when Fallout is calculating the chances of an attack striking a target. Runs after the hit chance is fully calculated normally, including applying the 95% cap.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - The hit chance (capped)
Critter arg1 - The attacker
Critter arg2 - The target of the attack
int     arg3 - The targeted bodypart
int     arg4 - Source tile (may differ from attacker's tile, when AI is considering potential fire position)
int     arg5 - Attack Type (one of ATKTYPE_*)
int     arg6 - Ranged flag. 1 means the hit chance is calculated by taking into account the bonuses/penalties of the distance to the target
int     arg7 - The raw hit chance before applying the cap

int     ret0 - the new hit chance
</code></pre></div></div> <h2 id="useanimobj"> <a href="#useanimobj" class="anchor-heading" aria-labelledby="useanimobj"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> UseAnimObj </h2> <p><code class="highlighter-rouge">HOOK_USEANIMOBJ</code> (hs_useanimobj.int)</p> <p>Runs before playing the “use” (usually “magic hands”) animation when a critter uses a scenery/container object on the map, or before walking/running animation if the player is at a distance from the object.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter that uses an object (usually dude_obj)
Obj     arg1 - the object being used
int     arg2 - the animation code being used (see ANIM_* in Animcomd.h)

int     ret0 - overrides the animation code (pass -1 if you want to skip the animation)
</code></pre></div></div> <h2 id="useobj"> <a href="#useobj" class="anchor-heading" aria-labelledby="useobj"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> UseObj </h2> <p><code class="highlighter-rouge">HOOK_USEOBJ</code> (hs_useobj.int)</p> <p>Runs when:</p> <ol> <li>a critter uses an object from inventory which have “Use” action flag set or it’s an active flare or dynamite.</li> <li>player uses an object from main interface</li> </ol> <p>This is fired before the object is used, and the relevant <code class="highlighter-rouge">use_obj</code> script procedures are run. You can disable default item behavior.</p> <p><strong>NOTE:</strong> You can’t remove and/or destroy this object during the hookscript (game will crash otherwise). To remove it, return 1.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - The user
Obj     arg1 - The object used

int     ret0 - overrides hard-coded handler and selects what should happen with the item (0 - place it back, 1 - remove it, -1 - use engine handler)
</code></pre></div></div> <h2 id="useobjon"> <a href="#useobjon" class="anchor-heading" aria-labelledby="useobjon"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> UseObjOn </h2> <p><code class="highlighter-rouge">HOOK_USEOBJON</code> (hs_useobjon.int)</p> <p>Runs when:</p> <ol> <li>a critter uses an object on another critter. (Or themselves)</li> <li>a critter uses an object from inventory screen AND this object does not have “Use” action flag set and it’s not active flare or explosive.</li> <li>player or AI uses any drug</li> </ol> <p>This is fired before the object is used, and the relevant use_obj_on script procedures are run. You can disable default item behavior. NOTE: you can’t remove and/or destroy this object during the hookscript (game will crash otherwise). To remove it, return 1.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - The target
Critter arg1 - The user
int     arg2 - The object used

int     ret0 - overrides hard-coded handler and selects what should happen with the item (0 - place it back, 1 - remove it, -1 - use engine handler)
</code></pre></div></div> <h2 id="useskill"> <a href="#useskill" class="anchor-heading" aria-labelledby="useskill"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> UseSkill </h2> <p><code class="highlighter-rouge">HOOK_USESKILL</code> (hs_useskill.int)</p> <p>Runs when using any skill on any object.</p> <p>This is fired before the default handlers are called, which you can override. In this case you should write your own skill use handler entirely, or otherwise nothing will happen (this includes fade in/fade out, time lapsing and messages - all of this can be scripted; to get vanilla text messages - use <code class="highlighter-rouge">message_str_game</code> along with <code class="highlighter-rouge">sprintf</code>). Suggested use - override first aid/doctor skills to buff/nerf them, override steal skill to disallow observing NPCs inventories in some cases. Doesn’t seem to run when lock picking.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - The user critter
Obj     arg1 - The target object
int     arg2 - skill being used
int     arg3 - skill bonus from items such as first aid kits

int     ret0 - overrides hard-coded handler (-1 - use engine handler, any other value - override)
</code></pre></div></div> <h2 id="useskillon"> <a href="#useskillon" class="anchor-heading" aria-labelledby="useskillon"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> UseSkillOn </h2> <p><code class="highlighter-rouge">HOOK_USESKILLON</code> (hs_useskillon.int)</p> <p>Runs before using any skill on any object. Lets you override the critter that uses the skill.</p> <p><strong>NOTE:</strong> The user critter can’t be overridden when using Steal skill.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the user critter (usually dude_obj)
Obj     arg1 - the target object/critter
int     arg2 - skill being used

int     ret0 - a new critter to override the user critter. Pass -1 to cancel the skill use, pass 0 to skip this return value
int     ret1 - pass 1 to allow the skill being used in combat (only for dude_obj or critter being controlled by the player)
</code></pre></div></div> <h2 id="withinperception"> <a href="#withinperception" class="anchor-heading" aria-labelledby="withinperception"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> WithinPerception </h2> <p><code class="highlighter-rouge">HOOK_WITHINPRECEPTION</code> (hs_withinperception.int)</p> <p>Runs when checking if one critter sees another critter. This is used in different situations like combat AI. You can override the result.</p> <p><strong>NOTE:</strong> <code class="highlighter-rouge">obj_can_see_obj</code> calls this first when deciding if critter can possibly see another critter with regard to perception, lighting, sneak factors.<br /> If check fails, the end result is false. If check succeeds (e.g. critter is within perception range), another check is made if there is any blocking tile between two critters (which includes stuff like windows, large bushes, barrels, etc.) and if there is - check still fails.<br /> You can override “within perception” check by returning 0 or 1, OR, as a convenience, you can also override blocking check after the perception check by returning 2 instead. In this case you should add “line of sight” check inside your hook script, otherwise critters will detect you through walls.</p> <p>This is fired after the default calculation is made.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - Watcher object
Obj     arg1 - Target object
int     arg2 - Result of vanilla function: 1 - within perception range, 0 - otherwise
int     arg3 - Type of hook:
    1 - when being called from obj_can_see_obj script function
    2 - when being called from obj_can_hear_obj script function (need to set ObjCanHearObjFix=1 in ddraw.ini)
    3 - when AI determines whether it sees a potential target when selecting attack targets
    0 - all other cases

int     ret0 - overrides the returned result of the function:
               0 - not in range (can't see)
               1 - in range (will see if not blocked)
               2 - forced detection (will see regardless, only used in obj_can_see_obj scripting function which is called by every critter in the game)
</code></pre></div></div> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
